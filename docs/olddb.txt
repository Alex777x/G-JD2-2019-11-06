CREATE TABLE "user_account" (
	"id" serial NOT NULL,
	"nickname" character varying(50) NOT NULL UNIQUE,
	"password" character varying(250) NOT NULL,
	"email" character varying(250) NOT NULL UNIQUE,
	"foto" character varying,
	"country_id" integer NOT NULL,
	"user_role" character varying NOT NULL,
	"user_status" character varying,
	"sum_games" integer,
	"won_games" integer,
	"created" TIMESTAMP NOT NULL,
	"updated" TIMESTAMP,
	CONSTRAINT "user_account_pk" PRIMARY KEY ("id")
) WITH (
  OIDS=FALSE
);



CREATE TABLE "tiket" (
	"id" serial NOT NULL,
	"user_account_id" integer NOT NULL,
	"tiket_title" character varying(50) NOT NULL,
	"tiket_text" TEXT NOT NULL,
	"status" character varying(50) NOT NULL,
	"created" TIMESTAMP NOT NULL,
	"updated" TIMESTAMP,
	CONSTRAINT "tiket_pk" PRIMARY KEY ("id")
) WITH (
  OIDS=FALSE
);



CREATE TABLE "country" (
	"id" serial NOT NULL,
	"country" character varying NOT NULL,
	"created" TIMESTAMP,
	"updated" TIMESTAMP,
	CONSTRAINT "country_pk" PRIMARY KEY ("id")
) WITH (
  OIDS=FALSE
);



CREATE TABLE "transaction" (
	"id" serial NOT NULL,
	"user_account_id" bigint NOT NULL,
	"amount" DECIMAL NOT NULL,
	"comment" character varying(50) NOT NULL,
	"created" TIMESTAMP NOT NULL,
	"updated" TIMESTAMP,
	CONSTRAINT "transaction_pk" PRIMARY KEY ("id")
) WITH (
  OIDS=FALSE
);



CREATE TABLE "player" (
	"id" serial NOT NULL,
	"game_id" integer NOT NULL,
	"user_account_id" integer NOT NULL,
	"position" character varying,
	"in_game" BOOLEAN NOT NULL,
	"state" character varying(50) NOT NULL,
	"stack" DECIMAL NOT NULL,
	"created" TIMESTAMP NOT NULL,
	"updated" TIMESTAMP NOT NULL,
	CONSTRAINT "player_pk" PRIMARY KEY ("id")
) WITH (
  OIDS=FALSE
);



CREATE TABLE "game" (
	"id" serial NOT NULL,
	"state" character varying NOT NULL,
	"bank" DECIMAL NOT NULL DEFAULT '0',
	"created" TIMESTAMP NOT NULL,
	"updated" TIMESTAMP NOT NULL,
	CONSTRAINT "game_pk" PRIMARY KEY ("id")
) WITH (
  OIDS=FALSE
);



CREATE TABLE "card" (
	"id" serial NOT NULL,
	"suit" character varying(50) NOT NULL,
	"rank" character varying NOT NULL,
	"filename" character varying NOT NULL UNIQUE,
	"created" TIMESTAMP NOT NULL,
	"updated" TIMESTAMP NOT NULL,
	CONSTRAINT "card_pk" PRIMARY KEY ("id")
) WITH (
  OIDS=FALSE
);



CREATE TABLE "action" (
	"id" serial NOT NULL,
	"player_id" integer NOT NULL,
	"bet" DECIMAL NOT NULL,
	"call" DECIMAL NOT NULL,
	"raise" DECIMAL NOT NULL,
	"fold" BOOLEAN NOT NULL,
	"check_check" BOOLEAN NOT NULL,
	"all_in" DECIMAL NOT NULL,
	"created" TIMESTAMP NOT NULL,
	"updated" TIMESTAMP NOT NULL,
	CONSTRAINT "action_pk" PRIMARY KEY ("id")
) WITH (
  OIDS=FALSE
);



CREATE TABLE "chat" (
	"id" serial NOT NULL,
	"game_id" integer NOT NULL,
	"user_account_id" integer NOT NULL,
	"message" character varying(50) NOT NULL,
	"created" TIMESTAMP NOT NULL,
	"updated" TIMESTAMP NOT NULL,
	CONSTRAINT "chat_pk" PRIMARY KEY ("id")
) WITH (
  OIDS=FALSE
);



CREATE TABLE "card_in_game" (
	"id" serial NOT NULL,
	"card_id" integer NOT NULL,
	"game_id" integer NOT NULL,
	"player_id" integer,
	"card_status" character varying NOT NULL,
	"created" TIMESTAMP NOT NULL,
	"updated" TIMESTAMP NOT NULL,
	CONSTRAINT "card_in_game_pk" PRIMARY KEY ("id")
) WITH (
  OIDS=FALSE
);



ALTER TABLE "user_account" ADD CONSTRAINT "user_account_fk0" FOREIGN KEY ("country_id") REFERENCES "country"("id");

ALTER TABLE "tiket" ADD CONSTRAINT "tiket_fk0" FOREIGN KEY ("user_account_id") REFERENCES "user_account"("id");


ALTER TABLE "transaction" ADD CONSTRAINT "transaction_fk0" FOREIGN KEY ("user_account_id") REFERENCES "user_account"("id");

ALTER TABLE "player" ADD CONSTRAINT "player_fk0" FOREIGN KEY ("game_id") REFERENCES "game"("id");
ALTER TABLE "player" ADD CONSTRAINT "player_fk1" FOREIGN KEY ("user_account_id") REFERENCES "user_account"("id");



ALTER TABLE "action" ADD CONSTRAINT "action_fk0" FOREIGN KEY ("player_id") REFERENCES "player"("id");

ALTER TABLE "chat" ADD CONSTRAINT "chat_fk0" FOREIGN KEY ("game_id") REFERENCES "game"("id");
ALTER TABLE "chat" ADD CONSTRAINT "chat_fk1" FOREIGN KEY ("user_account_id") REFERENCES "user_account"("id");

ALTER TABLE "card_in_game" ADD CONSTRAINT "card_in_game_fk0" FOREIGN KEY ("card_id") REFERENCES "card"("id");
ALTER TABLE "card_in_game" ADD CONSTRAINT "card_in_game_fk1" FOREIGN KEY ("game_id") REFERENCES "game"("id");
ALTER TABLE "card_in_game" ADD CONSTRAINT "card_in_game_fk2" FOREIGN KEY ("player_id") REFERENCES "player"("id");
